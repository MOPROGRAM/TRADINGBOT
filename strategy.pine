//@version=5
strategy("My Trading Bot Strategy", overlay=true)

// --- Inputs ---
adx_len = input.int(14, title="ADX Length")
rsi_len = input.int(14, title="RSI Length")
ema_short_len = input.int(9, title="Short EMA Length")
ema_long_len = input.int(21, title="Long EMA Length")
ema_trend_len = input.int(50, title="Trend EMA Length")
volume_sma_len = input.int(20, title="Volume SMA Length")

buy_rsi_level = input.float(50, title="Buy RSI Level")
buy_rsi_upper_level = input.float(70, title="Buy RSI Upper Level")
adx_trend_strength = input.float(20, title="ADX Trend Strength")
volume_multiplier = input.float(1.1, title="Volume Multiplier")

// --- Indicators ---
// Primary Timeframe (Current)
rsi = ta.rsi(close, rsi_len)
ema_short = ta.ema(close, ema_short_len)
ema_long = ta.ema(close, ema_long_len)
volume_sma = ta.sma(volume, volume_sma_len)
[di_plus, di_minus, adx] = ta.dmi(adx_len, adx_len)

// Higher Timeframes
ema_trend_15m = request.security(syminfo.tickerid, "15", ta.ema(close, ema_trend_len))
ema_trend_1h = request.security(syminfo.tickerid, "60", ta.ema(close, ema_trend_len))

// --- Conditions ---
// Buy Conditions
cond_rsi_in_range = rsi > buy_rsi_level and rsi < buy_rsi_upper_level
cond_ema_crossover = ta.crossover(ema_short, ema_long)
cond_price_above_trend = close > ema_trend_15m and close > ema_trend_1h
cond_adx_strong_trend = adx > adx_trend_strength
cond_volume_confirmation = volume > volume_sma * volume_multiplier
cond_dmi_confirmation = di_plus > di_minus

buy_signal = cond_rsi_in_range and cond_ema_crossover and cond_price_above_trend and cond_adx_strong_trend and cond_volume_confirmation and cond_dmi_confirmation

// Sell Conditions (Simplified version for Pine Script)
cond_ema_crossunder = ta.crossunder(ema_short, ema_long)
cond_rsi_overbought = ta.crossunder(rsi, 70) // Example of a simple sell condition

sell_signal = cond_ema_crossunder or cond_rsi_overbought

// --- Strategy Execution ---
if (buy_signal)
    strategy.entry("Buy", strategy.long)

if (sell_signal)
    strategy.close("Buy")

// --- Plotting ---
plot(ema_short, color=color.blue, title="Short EMA")
plot(ema_long, color=color.orange, title="Long EMA")
plot(ema_trend_1h, color=color.red, title="1h Trend EMA")

bgcolor(buy_signal ? color.new(color.green, 90) : na)
bgcolor(sell_signal ? color.new(color.red, 90) : na)
